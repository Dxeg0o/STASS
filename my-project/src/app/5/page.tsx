"use client";
import { useState } from "react";
import axios from "axios";

export default function Home() {
  const [altura, setAltura] = useState(null);
  const [radio, setRadio] = useState(null);
  const [grafico, setGrafico] = useState(null);
  const [error] = useState(null);

  const calcular = async () => {
    try {
      const data = {
        predictions: [
          {
            points: [
              {
                x: 802.5,
                y: 585,
              },
              {
                x: 796.875,
                y: 592.5,
              },
              {
                x: 796.875,
                y: 597.5,
              },
              {
                x: 795,
                y: 600,
              },
              {
                x: 795,
                y: 607.5,
              },
              {
                x: 793.125,
                y: 610,
              },
              {
                x: 793.125,
                y: 615,
              },
              {
                x: 791.25,
                y: 617.5,
              },
              {
                x: 791.25,
                y: 622.5,
              },
              {
                x: 789.375,
                y: 625,
              },
              {
                x: 789.375,
                y: 627.5,
              },
              {
                x: 787.5,
                y: 630,
              },
              {
                x: 787.5,
                y: 632.5,
              },
              {
                x: 785.625,
                y: 635,
              },
              {
                x: 785.625,
                y: 637.5,
              },
              {
                x: 781.875,
                y: 642.5,
              },
              {
                x: 781.875,
                y: 647.5,
              },
              {
                x: 780,
                y: 650,
              },
              {
                x: 780,
                y: 690,
              },
              {
                x: 778.125,
                y: 692.5,
              },
              {
                x: 778.125,
                y: 707.5,
              },
              {
                x: 776.25,
                y: 710,
              },
              {
                x: 776.25,
                y: 775,
              },
              {
                x: 778.125,
                y: 777.5,
              },
              {
                x: 778.125,
                y: 785,
              },
              {
                x: 780,
                y: 787.5,
              },
              {
                x: 780,
                y: 822.5,
              },
              {
                x: 781.875,
                y: 825,
              },
              {
                x: 781.875,
                y: 827.5,
              },
              {
                x: 783.75,
                y: 830,
              },
              {
                x: 783.75,
                y: 832.5,
              },
              {
                x: 785.625,
                y: 835,
              },
              {
                x: 785.625,
                y: 837.5,
              },
              {
                x: 787.5,
                y: 840,
              },
              {
                x: 787.5,
                y: 867.5,
              },
              {
                x: 789.375,
                y: 870,
              },
              {
                x: 789.375,
                y: 872.5,
              },
              {
                x: 791.25,
                y: 875,
              },
              {
                x: 791.25,
                y: 877.5,
              },
              {
                x: 793.125,
                y: 880,
              },
              {
                x: 793.125,
                y: 882.5,
              },
              {
                x: 795,
                y: 885,
              },
              {
                x: 795,
                y: 905,
              },
              {
                x: 796.875,
                y: 907.5,
              },
              {
                x: 796.875,
                y: 910,
              },
              {
                x: 800.625,
                y: 915,
              },
              {
                x: 800.625,
                y: 917.5,
              },
              {
                x: 802.5,
                y: 920,
              },
              {
                x: 802.5,
                y: 932.5,
              },
              {
                x: 804.375,
                y: 935,
              },
              {
                x: 804.375,
                y: 937.5,
              },
              {
                x: 808.125,
                y: 942.5,
              },
              {
                x: 808.125,
                y: 947.5,
              },
              {
                x: 810,
                y: 950,
              },
              {
                x: 810,
                y: 960,
              },
              {
                x: 811.875,
                y: 962.5,
              },
              {
                x: 811.875,
                y: 965,
              },
              {
                x: 815.625,
                y: 970,
              },
              {
                x: 815.625,
                y: 972.5,
              },
              {
                x: 817.5,
                y: 975,
              },
              {
                x: 817.5,
                y: 990,
              },
              {
                x: 819.375,
                y: 992.5,
              },
              {
                x: 819.375,
                y: 995,
              },
              {
                x: 821.25,
                y: 997.5,
              },
              {
                x: 821.25,
                y: 1000,
              },
              {
                x: 823.125,
                y: 1002.5,
              },
              {
                x: 823.125,
                y: 1005,
              },
              {
                x: 825,
                y: 1007.5,
              },
              {
                x: 825,
                y: 1025,
              },
              {
                x: 826.875,
                y: 1027.5,
              },
              {
                x: 826.875,
                y: 1030,
              },
              {
                x: 828.75,
                y: 1032.5,
              },
              {
                x: 828.75,
                y: 1035,
              },
              {
                x: 830.625,
                y: 1037.5,
              },
              {
                x: 830.625,
                y: 1040,
              },
              {
                x: 832.5,
                y: 1042.5,
              },
              {
                x: 832.5,
                y: 1062.5,
              },
              {
                x: 834.375,
                y: 1065,
              },
              {
                x: 834.375,
                y: 1067.5,
              },
              {
                x: 838.125,
                y: 1072.5,
              },
              {
                x: 838.125,
                y: 1075,
              },
              {
                x: 840,
                y: 1077.5,
              },
              {
                x: 840,
                y: 1102.5,
              },
              {
                x: 847.5,
                y: 1112.5,
              },
              {
                x: 847.5,
                y: 1115,
              },
              {
                x: 849.375,
                y: 1117.5,
              },
              {
                x: 873.75,
                y: 1117.5,
              },
              {
                x: 875.625,
                y: 1115,
              },
              {
                x: 875.625,
                y: 1092.5,
              },
              {
                x: 870,
                y: 1085,
              },
              {
                x: 870,
                y: 1080,
              },
              {
                x: 868.125,
                y: 1077.5,
              },
              {
                x: 868.125,
                y: 1062.5,
              },
              {
                x: 862.5,
                y: 1055,
              },
              {
                x: 862.5,
                y: 1050,
              },
              {
                x: 860.625,
                y: 1047.5,
              },
              {
                x: 860.625,
                y: 1032.5,
              },
              {
                x: 855,
                y: 1025,
              },
              {
                x: 855,
                y: 1020,
              },
              {
                x: 853.125,
                y: 1017.5,
              },
              {
                x: 853.125,
                y: 1005,
              },
              {
                x: 851.25,
                y: 1002.5,
              },
              {
                x: 851.25,
                y: 1000,
              },
              {
                x: 847.5,
                y: 995,
              },
              {
                x: 847.5,
                y: 992.5,
              },
              {
                x: 845.625,
                y: 990,
              },
              {
                x: 845.625,
                y: 980,
              },
              {
                x: 843.75,
                y: 977.5,
              },
              {
                x: 843.75,
                y: 972.5,
              },
              {
                x: 840,
                y: 967.5,
              },
              {
                x: 840,
                y: 965,
              },
              {
                x: 838.125,
                y: 962.5,
              },
              {
                x: 838.125,
                y: 952.5,
              },
              {
                x: 836.25,
                y: 950,
              },
              {
                x: 836.25,
                y: 947.5,
              },
              {
                x: 834.375,
                y: 945,
              },
              {
                x: 834.375,
                y: 942.5,
              },
              {
                x: 832.5,
                y: 940,
              },
              {
                x: 832.5,
                y: 937.5,
              },
              {
                x: 830.625,
                y: 935,
              },
              {
                x: 830.625,
                y: 917.5,
              },
              {
                x: 828.75,
                y: 915,
              },
              {
                x: 828.75,
                y: 912.5,
              },
              {
                x: 825,
                y: 907.5,
              },
              {
                x: 825,
                y: 905,
              },
              {
                x: 823.125,
                y: 902.5,
              },
              {
                x: 823.125,
                y: 890,
              },
              {
                x: 821.25,
                y: 887.5,
              },
              {
                x: 821.25,
                y: 885,
              },
              {
                x: 817.5,
                y: 880,
              },
              {
                x: 817.5,
                y: 877.5,
              },
              {
                x: 815.625,
                y: 875,
              },
              {
                x: 815.625,
                y: 857.5,
              },
              {
                x: 813.75,
                y: 855,
              },
              {
                x: 813.75,
                y: 850,
              },
              {
                x: 810,
                y: 845,
              },
              {
                x: 810,
                y: 840,
              },
              {
                x: 808.125,
                y: 837.5,
              },
              {
                x: 808.125,
                y: 820,
              },
              {
                x: 806.25,
                y: 817.5,
              },
              {
                x: 806.25,
                y: 812.5,
              },
              {
                x: 804.375,
                y: 810,
              },
              {
                x: 804.375,
                y: 807.5,
              },
              {
                x: 802.5,
                y: 805,
              },
              {
                x: 802.5,
                y: 797.5,
              },
              {
                x: 800.625,
                y: 795,
              },
              {
                x: 800.625,
                y: 752.5,
              },
              {
                x: 798.75,
                y: 750,
              },
              {
                x: 798.75,
                y: 730,
              },
              {
                x: 796.875,
                y: 727.5,
              },
              {
                x: 796.875,
                y: 710,
              },
              {
                x: 798.75,
                y: 707.5,
              },
              {
                x: 798.75,
                y: 690,
              },
              {
                x: 800.625,
                y: 687.5,
              },
              {
                x: 800.625,
                y: 650,
              },
              {
                x: 802.5,
                y: 647.5,
              },
              {
                x: 802.5,
                y: 637.5,
              },
              {
                x: 804.375,
                y: 635,
              },
              {
                x: 804.375,
                y: 632.5,
              },
              {
                x: 806.25,
                y: 630,
              },
              {
                x: 806.25,
                y: 622.5,
              },
              {
                x: 808.125,
                y: 620,
              },
              {
                x: 808.125,
                y: 585,
              },
            ],
          },
        ],
      };

      const response = await axios.post(
        "http://127.0.0.1:5000/api/calculate",
        data
      );

      setAltura(response.data.altura);
      setRadio(response.data.radio);
      setGrafico(response.data.grafico);
    } catch (err) {
      console.error("Error al calcular:", err);
    }
  };

  return (
    <div>
      <h1>Calculadora de Espárragos</h1>
      <button onClick={calcular}>Calcular</button>
      {altura && <p>Altura: {altura}</p>}
      {radio && <p>Radio: {radio}</p>}
      {grafico && (
        <div>
          <h2>Gráfico:</h2>
          <img src={`data:image/png;base64,${grafico}`} alt="Gráfico" />
        </div>
      )}
      {error && <p style={{ color: "red" }}>{error}</p>}
    </div>
  );
}

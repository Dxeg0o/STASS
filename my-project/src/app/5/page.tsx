"use client";
import { useState } from "react";
import axios from "axios";

export default function Home() {
  const [altura, setAltura] = useState(null);
  const [radio, setRadio] = useState(null);
  const [grafico, setGrafico] = useState(null);
  const [error, setError] = useState(null);

  const calcular = async () => {
    try {
      const data = {
        predictions: [
          {
            points: [
              {
                x: 260,
                y: 61,
              },
              {
                x: 260,
                y: 65,
              },
              {
                x: 259,
                y: 66,
              },
              {
                x: 259,
                y: 68,
              },
              {
                x: 258,
                y: 69,
              },
              {
                x: 258,
                y: 71,
              },
              {
                x: 257,
                y: 72,
              },
              {
                x: 257,
                y: 89,
              },
              {
                x: 258,
                y: 90,
              },
              {
                x: 258,
                y: 91,
              },
              {
                x: 259,
                y: 92,
              },
              {
                x: 259,
                y: 94,
              },
              {
                x: 260,
                y: 95,
              },
              {
                x: 260,
                y: 98,
              },
              {
                x: 261,
                y: 99,
              },
              {
                x: 261,
                y: 100,
              },
              {
                x: 263,
                y: 102,
              },
              {
                x: 263,
                y: 103,
              },
              {
                x: 264,
                y: 104,
              },
              {
                x: 264,
                y: 107,
              },
              {
                x: 265,
                y: 108,
              },
              {
                x: 265,
                y: 110,
              },
              {
                x: 266,
                y: 111,
              },
              {
                x: 266,
                y: 112,
              },
              {
                x: 267,
                y: 113,
              },
              {
                x: 267,
                y: 116,
              },
              {
                x: 268,
                y: 117,
              },
              {
                x: 268,
                y: 124,
              },
              {
                x: 269,
                y: 125,
              },
              {
                x: 269,
                y: 126,
              },
              {
                x: 271,
                y: 128,
              },
              {
                x: 271,
                y: 129,
              },
              {
                x: 272,
                y: 130,
              },
              {
                x: 272,
                y: 132,
              },
              {
                x: 273,
                y: 133,
              },
              {
                x: 273,
                y: 134,
              },
              {
                x: 276,
                y: 137,
              },
              {
                x: 276,
                y: 138,
              },
              {
                x: 280,
                y: 142,
              },
              {
                x: 280,
                y: 146,
              },
              {
                x: 283,
                y: 149,
              },
              {
                x: 283,
                y: 150,
              },
              {
                x: 284,
                y: 151,
              },
              {
                x: 284,
                y: 157,
              },
              {
                x: 285,
                y: 158,
              },
              {
                x: 285,
                y: 159,
              },
              {
                x: 287,
                y: 161,
              },
              {
                x: 287,
                y: 163,
              },
              {
                x: 288,
                y: 164,
              },
              {
                x: 288,
                y: 167,
              },
              {
                x: 289,
                y: 168,
              },
              {
                x: 289,
                y: 169,
              },
              {
                x: 291,
                y: 171,
              },
              {
                x: 291,
                y: 172,
              },
              {
                x: 292,
                y: 173,
              },
              {
                x: 292,
                y: 178,
              },
              {
                x: 293,
                y: 179,
              },
              {
                x: 293,
                y: 180,
              },
              {
                x: 295,
                y: 182,
              },
              {
                x: 295,
                y: 184,
              },
              {
                x: 296,
                y: 185,
              },
              {
                x: 296,
                y: 189,
              },
              {
                x: 297,
                y: 190,
              },
              {
                x: 297,
                y: 191,
              },
              {
                x: 299,
                y: 193,
              },
              {
                x: 299,
                y: 195,
              },
              {
                x: 300,
                y: 196,
              },
              {
                x: 300,
                y: 202,
              },
              {
                x: 301,
                y: 203,
              },
              {
                x: 301,
                y: 204,
              },
              {
                x: 303,
                y: 206,
              },
              {
                x: 303,
                y: 208,
              },
              {
                x: 304,
                y: 209,
              },
              {
                x: 304,
                y: 215,
              },
              {
                x: 305,
                y: 216,
              },
              {
                x: 305,
                y: 218,
              },
              {
                x: 307,
                y: 220,
              },
              {
                x: 307,
                y: 222,
              },
              {
                x: 308,
                y: 223,
              },
              {
                x: 308,
                y: 232,
              },
              {
                x: 309,
                y: 233,
              },
              {
                x: 309,
                y: 235,
              },
              {
                x: 311,
                y: 237,
              },
              {
                x: 311,
                y: 239,
              },
              {
                x: 312,
                y: 240,
              },
              {
                x: 312,
                y: 250,
              },
              {
                x: 313,
                y: 251,
              },
              {
                x: 313,
                y: 252,
              },
              {
                x: 314,
                y: 253,
              },
              {
                x: 314,
                y: 254,
              },
              {
                x: 315,
                y: 255,
              },
              {
                x: 315,
                y: 257,
              },
              {
                x: 316,
                y: 258,
              },
              {
                x: 316,
                y: 273,
              },
              {
                x: 317,
                y: 274,
              },
              {
                x: 317,
                y: 276,
              },
              {
                x: 318,
                y: 277,
              },
              {
                x: 318,
                y: 278,
              },
              {
                x: 319,
                y: 279,
              },
              {
                x: 319,
                y: 282,
              },
              {
                x: 320,
                y: 283,
              },
              {
                x: 320,
                y: 386,
              },
              {
                x: 319,
                y: 387,
              },
              {
                x: 319,
                y: 392,
              },
              {
                x: 318,
                y: 393,
              },
              {
                x: 318,
                y: 395,
              },
              {
                x: 317,
                y: 396,
              },
              {
                x: 317,
                y: 399,
              },
              {
                x: 316,
                y: 400,
              },
              {
                x: 316,
                y: 438,
              },
              {
                x: 315,
                y: 439,
              },
              {
                x: 315,
                y: 442,
              },
              {
                x: 314,
                y: 443,
              },
              {
                x: 314,
                y: 445,
              },
              {
                x: 313,
                y: 446,
              },
              {
                x: 313,
                y: 448,
              },
              {
                x: 312,
                y: 449,
              },
              {
                x: 312,
                y: 461,
              },
              {
                x: 311,
                y: 462,
              },
              {
                x: 311,
                y: 465,
              },
              {
                x: 310,
                y: 466,
              },
              {
                x: 310,
                y: 467,
              },
              {
                x: 309,
                y: 468,
              },
              {
                x: 309,
                y: 469,
              },
              {
                x: 308,
                y: 470,
              },
              {
                x: 308,
                y: 484,
              },
              {
                x: 307,
                y: 485,
              },
              {
                x: 307,
                y: 488,
              },
              {
                x: 306,
                y: 489,
              },
              {
                x: 306,
                y: 490,
              },
              {
                x: 305,
                y: 491,
              },
              {
                x: 305,
                y: 492,
              },
              {
                x: 304,
                y: 493,
              },
              {
                x: 304,
                y: 502,
              },
              {
                x: 303,
                y: 503,
              },
              {
                x: 303,
                y: 505,
              },
              {
                x: 301,
                y: 507,
              },
              {
                x: 301,
                y: 508,
              },
              {
                x: 300,
                y: 509,
              },
              {
                x: 300,
                y: 513,
              },
              {
                x: 299,
                y: 514,
              },
              {
                x: 299,
                y: 515,
              },
              {
                x: 297,
                y: 517,
              },
              {
                x: 297,
                y: 519,
              },
              {
                x: 296,
                y: 520,
              },
              {
                x: 296,
                y: 525,
              },
              {
                x: 295,
                y: 526,
              },
              {
                x: 295,
                y: 528,
              },
              {
                x: 293,
                y: 530,
              },
              {
                x: 293,
                y: 531,
              },
              {
                x: 292,
                y: 532,
              },
              {
                x: 292,
                y: 538,
              },
              {
                x: 291,
                y: 539,
              },
              {
                x: 291,
                y: 540,
              },
              {
                x: 290,
                y: 541,
              },
              {
                x: 290,
                y: 542,
              },
              {
                x: 289,
                y: 543,
              },
              {
                x: 289,
                y: 544,
              },
              {
                x: 288,
                y: 545,
              },
              {
                x: 288,
                y: 549,
              },
              {
                x: 287,
                y: 550,
              },
              {
                x: 287,
                y: 551,
              },
              {
                x: 286,
                y: 552,
              },
              {
                x: 286,
                y: 553,
              },
              {
                x: 285,
                y: 554,
              },
              {
                x: 285,
                y: 555,
              },
              {
                x: 284,
                y: 556,
              },
              {
                x: 284,
                y: 559,
              },
              {
                x: 283,
                y: 560,
              },
              {
                x: 283,
                y: 561,
              },
              {
                x: 281,
                y: 563,
              },
              {
                x: 281,
                y: 564,
              },
              {
                x: 280,
                y: 565,
              },
              {
                x: 280,
                y: 569,
              },
              {
                x: 279,
                y: 570,
              },
              {
                x: 279,
                y: 571,
              },
              {
                x: 277,
                y: 573,
              },
              {
                x: 277,
                y: 574,
              },
              {
                x: 276,
                y: 575,
              },
              {
                x: 276,
                y: 578,
              },
              {
                x: 275,
                y: 579,
              },
              {
                x: 275,
                y: 580,
              },
              {
                x: 273,
                y: 582,
              },
              {
                x: 273,
                y: 583,
              },
              {
                x: 272,
                y: 584,
              },
              {
                x: 272,
                y: 588,
              },
              {
                x: 271,
                y: 589,
              },
              {
                x: 271,
                y: 590,
              },
              {
                x: 269,
                y: 592,
              },
              {
                x: 269,
                y: 593,
              },
              {
                x: 268,
                y: 594,
              },
              {
                x: 268,
                y: 599,
              },
              {
                x: 267,
                y: 600,
              },
              {
                x: 267,
                y: 602,
              },
              {
                x: 264,
                y: 605,
              },
              {
                x: 264,
                y: 611,
              },
              {
                x: 263,
                y: 612,
              },
              {
                x: 263,
                y: 614,
              },
              {
                x: 261,
                y: 616,
              },
              {
                x: 261,
                y: 619,
              },
              {
                x: 260,
                y: 620,
              },
              {
                x: 260,
                y: 621,
              },
              {
                x: 261,
                y: 622,
              },
              {
                x: 261,
                y: 624,
              },
              {
                x: 265,
                y: 628,
              },
              {
                x: 266,
                y: 628,
              },
              {
                x: 267,
                y: 629,
              },
              {
                x: 267,
                y: 630,
              },
              {
                x: 268,
                y: 630,
              },
              {
                x: 269,
                y: 631,
              },
              {
                x: 281,
                y: 631,
              },
              {
                x: 283,
                y: 629,
              },
              {
                x: 283,
                y: 628,
              },
              {
                x: 284,
                y: 627,
              },
              {
                x: 284,
                y: 626,
              },
              {
                x: 286,
                y: 624,
              },
              {
                x: 286,
                y: 623,
              },
              {
                x: 287,
                y: 622,
              },
              {
                x: 287,
                y: 611,
              },
              {
                x: 288,
                y: 610,
              },
              {
                x: 288,
                y: 608,
              },
              {
                x: 290,
                y: 606,
              },
              {
                x: 290,
                y: 604,
              },
              {
                x: 291,
                y: 603,
              },
              {
                x: 291,
                y: 600,
              },
              {
                x: 292,
                y: 599,
              },
              {
                x: 292,
                y: 597,
              },
              {
                x: 294,
                y: 595,
              },
              {
                x: 294,
                y: 593,
              },
              {
                x: 295,
                y: 592,
              },
              {
                x: 295,
                y: 584,
              },
              {
                x: 296,
                y: 583,
              },
              {
                x: 296,
                y: 582,
              },
              {
                x: 298,
                y: 580,
              },
              {
                x: 298,
                y: 579,
              },
              {
                x: 299,
                y: 578,
              },
              {
                x: 299,
                y: 573,
              },
              {
                x: 300,
                y: 572,
              },
              {
                x: 300,
                y: 570,
              },
              {
                x: 302,
                y: 568,
              },
              {
                x: 302,
                y: 567,
              },
              {
                x: 303,
                y: 566,
              },
              {
                x: 303,
                y: 561,
              },
              {
                x: 304,
                y: 560,
              },
              {
                x: 304,
                y: 559,
              },
              {
                x: 305,
                y: 558,
              },
              {
                x: 305,
                y: 557,
              },
              {
                x: 306,
                y: 556,
              },
              {
                x: 306,
                y: 555,
              },
              {
                x: 307,
                y: 554,
              },
              {
                x: 307,
                y: 550,
              },
              {
                x: 308,
                y: 549,
              },
              {
                x: 308,
                y: 548,
              },
              {
                x: 310,
                y: 546,
              },
              {
                x: 310,
                y: 545,
              },
              {
                x: 311,
                y: 544,
              },
              {
                x: 311,
                y: 540,
              },
              {
                x: 312,
                y: 539,
              },
              {
                x: 312,
                y: 538,
              },
              {
                x: 313,
                y: 537,
              },
              {
                x: 313,
                y: 536,
              },
              {
                x: 314,
                y: 535,
              },
              {
                x: 314,
                y: 534,
              },
              {
                x: 315,
                y: 533,
              },
              {
                x: 315,
                y: 527,
              },
              {
                x: 316,
                y: 526,
              },
              {
                x: 316,
                y: 524,
              },
              {
                x: 318,
                y: 522,
              },
              {
                x: 318,
                y: 520,
              },
              {
                x: 319,
                y: 519,
              },
              {
                x: 319,
                y: 513,
              },
              {
                x: 320,
                y: 512,
              },
              {
                x: 320,
                y: 510,
              },
              {
                x: 322,
                y: 508,
              },
              {
                x: 322,
                y: 506,
              },
              {
                x: 323,
                y: 505,
              },
              {
                x: 323,
                y: 495,
              },
              {
                x: 324,
                y: 494,
              },
              {
                x: 324,
                y: 492,
              },
              {
                x: 326,
                y: 490,
              },
              {
                x: 326,
                y: 487,
              },
              {
                x: 327,
                y: 486,
              },
              {
                x: 327,
                y: 476,
              },
              {
                x: 328,
                y: 475,
              },
              {
                x: 328,
                y: 472,
              },
              {
                x: 329,
                y: 471,
              },
              {
                x: 329,
                y: 469,
              },
              {
                x: 330,
                y: 468,
              },
              {
                x: 330,
                y: 464,
              },
              {
                x: 331,
                y: 463,
              },
              {
                x: 331,
                y: 443,
              },
              {
                x: 332,
                y: 442,
              },
              {
                x: 332,
                y: 435,
              },
              {
                x: 333,
                y: 434,
              },
              {
                x: 333,
                y: 430,
              },
              {
                x: 334,
                y: 429,
              },
              {
                x: 334,
                y: 421,
              },
              {
                x: 335,
                y: 420,
              },
              {
                x: 335,
                y: 396,
              },
              {
                x: 336,
                y: 395,
              },
              {
                x: 336,
                y: 292,
              },
              {
                x: 335,
                y: 291,
              },
              {
                x: 335,
                y: 273,
              },
              {
                x: 334,
                y: 272,
              },
              {
                x: 334,
                y: 268,
              },
              {
                x: 333,
                y: 267,
              },
              {
                x: 333,
                y: 265,
              },
              {
                x: 332,
                y: 264,
              },
              {
                x: 332,
                y: 259,
              },
              {
                x: 331,
                y: 258,
              },
              {
                x: 331,
                y: 245,
              },
              {
                x: 330,
                y: 244,
              },
              {
                x: 330,
                y: 243,
              },
              {
                x: 329,
                y: 242,
              },
              {
                x: 329,
                y: 241,
              },
              {
                x: 328,
                y: 240,
              },
              {
                x: 328,
                y: 239,
              },
              {
                x: 327,
                y: 238,
              },
              {
                x: 327,
                y: 233,
              },
              {
                x: 326,
                y: 232,
              },
              {
                x: 326,
                y: 230,
              },
              {
                x: 324,
                y: 228,
              },
              {
                x: 324,
                y: 226,
              },
              {
                x: 323,
                y: 225,
              },
              {
                x: 323,
                y: 217,
              },
              {
                x: 322,
                y: 216,
              },
              {
                x: 322,
                y: 214,
              },
              {
                x: 321,
                y: 213,
              },
              {
                x: 321,
                y: 212,
              },
              {
                x: 320,
                y: 211,
              },
              {
                x: 320,
                y: 210,
              },
              {
                x: 319,
                y: 209,
              },
              {
                x: 319,
                y: 202,
              },
              {
                x: 318,
                y: 201,
              },
              {
                x: 318,
                y: 200,
              },
              {
                x: 316,
                y: 198,
              },
              {
                x: 316,
                y: 196,
              },
              {
                x: 315,
                y: 195,
              },
              {
                x: 315,
                y: 189,
              },
              {
                x: 314,
                y: 188,
              },
              {
                x: 314,
                y: 187,
              },
              {
                x: 313,
                y: 186,
              },
              {
                x: 313,
                y: 185,
              },
              {
                x: 312,
                y: 184,
              },
              {
                x: 312,
                y: 182,
              },
              {
                x: 311,
                y: 181,
              },
              {
                x: 311,
                y: 174,
              },
              {
                x: 308,
                y: 171,
              },
              {
                x: 308,
                y: 170,
              },
              {
                x: 307,
                y: 169,
              },
              {
                x: 307,
                y: 165,
              },
              {
                x: 303,
                y: 161,
              },
              {
                x: 303,
                y: 157,
              },
              {
                x: 300,
                y: 154,
              },
              {
                x: 300,
                y: 153,
              },
              {
                x: 299,
                y: 152,
              },
              {
                x: 299,
                y: 147,
              },
              {
                x: 298,
                y: 146,
              },
              {
                x: 298,
                y: 145,
              },
              {
                x: 295,
                y: 142,
              },
              {
                x: 295,
                y: 138,
              },
              {
                x: 294,
                y: 137,
              },
              {
                x: 294,
                y: 136,
              },
              {
                x: 292,
                y: 134,
              },
              {
                x: 292,
                y: 133,
              },
              {
                x: 291,
                y: 132,
              },
              {
                x: 291,
                y: 125,
              },
              {
                x: 290,
                y: 124,
              },
              {
                x: 290,
                y: 122,
              },
              {
                x: 289,
                y: 121,
              },
              {
                x: 289,
                y: 119,
              },
              {
                x: 288,
                y: 118,
              },
              {
                x: 288,
                y: 116,
              },
              {
                x: 287,
                y: 115,
              },
              {
                x: 287,
                y: 106,
              },
              {
                x: 286,
                y: 105,
              },
              {
                x: 286,
                y: 104,
              },
              {
                x: 284,
                y: 102,
              },
              {
                x: 284,
                y: 101,
              },
              {
                x: 283,
                y: 100,
              },
              {
                x: 283,
                y: 95,
              },
              {
                x: 282,
                y: 94,
              },
              {
                x: 282,
                y: 93,
              },
              {
                x: 280,
                y: 91,
              },
              {
                x: 280,
                y: 89,
              },
              {
                x: 279,
                y: 88,
              },
              {
                x: 279,
                y: 82,
              },
              {
                x: 278,
                y: 81,
              },
              {
                x: 278,
                y: 80,
              },
              {
                x: 275,
                y: 77,
              },
              {
                x: 275,
                y: 75,
              },
              {
                x: 274,
                y: 74,
              },
              {
                x: 274,
                y: 73,
              },
              {
                x: 273,
                y: 73,
              },
              {
                x: 272,
                y: 72,
              },
              {
                x: 272,
                y: 71,
              },
              {
                x: 271,
                y: 70,
              },
              {
                x: 271,
                y: 69,
              },
              {
                x: 270,
                y: 68,
              },
              {
                x: 269,
                y: 68,
              },
              {
                x: 267,
                y: 66,
              },
              {
                x: 267,
                y: 65,
              },
              {
                x: 263,
                y: 61,
              },
            ],
          },
        ],
      };

      const response = await axios.post(
        "http://127.0.0.1:5000/api/calculate",
        data
      );

      setAltura(response.data.altura);
      setRadio(response.data.radio);
      setGrafico(response.data.grafico);
    } catch (err) {
      console.error("Error al calcular:", err);
    }
  };

  return (
    <div>
      <h1>Calculadora de Espárragos</h1>
      <button onClick={calcular}>Calcular</button>
      {altura && <p>Altura: {altura}</p>}
      {radio && <p>Radio: {radio}</p>}
      {grafico && (
        <div>
          <h2>Gráfico:</h2>
          <img src={`data:image/png;base64,${grafico}`} alt="Gráfico" />
        </div>
      )}
      {error && <p style={{ color: "red" }}>{error}</p>}
    </div>
  );
}
